dbgap$year =str_split_fixed(dbgap$date, '-', 2)[,1]
dbgap$repository = "dbGaP"
dbgap$year[dbgap$year==""] = "NA"
dbgap = subset(dbgap, year > 2017)
dbgap$total_all = length(unique(dbgap$dataset_id))
dbgap$filename
substr(dbgap$filename, 8,20)
dbgap$phe = substr(dbgap$filename, 8,19)
ega_dbgap = rbind(ega,dbgap, fill = T)
################
# study level  #
################
unknown_only = subset(ega_dbgap, male == 0 & female == 0)
unknown_only$label = "U"
female_only = subset(subset(ega_dbgap, male == 0 & unknown == 0))
female_only$label = 'F'
male_only = subset(ega_dbgap, female == 0 & unknown == 0)
male_only$label = 'M'
female_and_male = subset(ega_dbgap, female != 0 & male != 0 & unknown == 0)
female_and_male$label = 'F&M'
female_and_unknown = subset(ega_dbgap, female != 0 & male == 0 & unknown != 0)
female_and_unknown$label = 'F&U'
male_and_unknown = subset(ega_dbgap, female == 0 & male != 0 & unknown != 0)
male_and_unknown$label = 'M&U'
female_and_male_and_unknown = subset(ega_dbgap, female != 0 & male != 0 & unknown != 0)
female_and_male_and_unknown$label = 'F&M&U'
female_and_male_and_unknown
dbgap_phe_fmu = subset(dbgap_phe , dataset_id %in% female_and_male_and_unknown$phe)
dbgap_phe
dbgap_phe =fread("/media/victoria/VICTORIA_EXTERNAL_DISK/BioHackathon2021/biohackathon-project-35/dbpgap/archived/summary_primary_phenotype.tsv")
dbgap_phe$dataset_id = substr(dbgap_phe$`study accession`, 1, 12)
dbgap_phe_fmu = subset(dbgap_phe , dataset_id %in% female_and_male_and_unknown$phe)
dbgap_phe =fread("/media/victoria/VICTORIA_EXTERNAL_DISK/BioHackathon2021/biohackathon-project-35/dbpgap/archived/summary_primary_phenotype.tsv")
dbgap_phe$dataset_id = substr(dbgap_phe$`study accession`, 1, 12)
dbgap_phe_fmu = subset(dbgap_phe , dataset_id %in% female_and_male_and_unknown$phe)
dbgap_phe_fmu $c = 1
dbgap_phe_fmu_total = dbgap_phe_fmu%>%group_by(phenotype) %>% summarise(total = sum(c))
dbgap_phe_fmu_total = dbgap_phe_fmu%>%group_by(rimary phenotype) %>% summarise(total = sum(c))
dbgap_phe_fmu_total = dbgap_phe_fmu%>%group_by(`primary phenotype`) %>% summarise(total = sum(c))
top20 = subset(dbgap_phe_fmu_total,total> 720)
top20$phenotype = factor(top20$phenotype, levels = arrange(top20, desc(total))$phenotype)
dbgap_phe =fread("/media/victoria/VICTORIA_EXTERNAL_DISK/BioHackathon2021/biohackathon-project-35/dbpgap/archived/summary_primary_phenotype.tsv")
dbgap_phe$dataset_id = substr(dbgap_phe$`study accession`, 1, 12)
dbgap_phe_fmu = subset(dbgap_phe , dataset_id %in% female_and_male_and_unknown$phe)
dbgap_phe_fmu $c = 1
dbgap_phe_fmu_total = dbgap_phe_fmu%>%group_by(`primary phenotype`) %>% summarise(total = sum(c))
arrange(dbgap_phe_fmu_total, desc(total))
top20 = subset(dbgap_phe_fmu_total,total> 720)
top20$`primary phenotype` = factor(top20$phenotype, levels = arrange(top20, desc(total))$`primary phenotype`)
top20 = subset(dbgap_phe_fmu_total,total>10)
top20$`primary phenotype` = factor(top20$phenotype, levels = arrange(top20, desc(total))$`primary phenotype`)
top20 = subset(dbgap_phe_fmu_total,total>10)
top20$`primary phenotype` = factor(top20$`primary phenotype`, levels = arrange(top20, desc(total))$`primary phenotype`)
ggplot(top20, aes(x = `primary phenotype`, y = total))+
geom_bar(stat="identity")+
theme_minimal()+
theme(axis.text.x = element_text(size = 10, face = "bold", angle = 45, hjust = 1, vjust = 1),
# axis.text.x = element_text(size = 12),
strip.text = element_text(size = 16, face = "bold"))
top20 = subset(dbgap_phe_fmu_total,total>30)
top20$`primary phenotype` = factor(top20$`primary phenotype`, levels = arrange(top20, desc(total))$`primary phenotype`)
ggplot(top20, aes(x = `primary phenotype`, y = total))+
geom_bar(stat="identity")+
theme_minimal()+
theme(axis.text.x = element_text(size = 10, face = "bold", angle = 45, hjust = 1, vjust = 1),
# axis.text.x = element_text(size = 12),
strip.text = element_text(size = 16, face = "bold"))
top20 = subset(dbgap_phe_fmu_total,total>20)
top20$`primary phenotype` = factor(top20$`primary phenotype`, levels = arrange(top20, desc(total))$`primary phenotype`)
ggplot(top20, aes(x = `primary phenotype`, y = total))+
geom_bar(stat="identity")+
theme_minimal()+
theme(axis.text.x = element_text(size = 10, face = "bold", angle = 45, hjust = 1, vjust = 1),
# axis.text.x = element_text(size = 12),
strip.text = element_text(size = 16, face = "bold"))
top20 = subset(dbgap_phe_fmu_total,total>25)
top20$`primary phenotype` = factor(top20$`primary phenotype`, levels = arrange(top20, desc(total))$`primary phenotype`)
ggplot(top20, aes(x = `primary phenotype`, y = total))+
geom_bar(stat="identity")+
theme_minimal()+
theme(axis.text.x = element_text(size = 10, face = "bold", angle = 45, hjust = 1, vjust = 1),
# axis.text.x = element_text(size = 12),
strip.text = element_text(size = 16, face = "bold"))
library(data.table)
library(reshape2)
library(ggplot2)
library(stringr)
library(dplyr)
# Load data
ega = fread("../ega/EGA_with_NULL.csv")
ega_m = melt(ega, id.vars = c("ega_stable_id", "repository", "to_char", "total"))
colnames(ega_m)[colnames(ega_m) == "ega_stable_id"] = "dataset_id"
dbgap = fread("../dbpgap/summary_fourth.csv")
dbgap$total = dbgap$male +  dbgap$female +  dbgap$unknown
dbgap$date = parse_date_time(dbgap$date, orders = c('mdy', 'dmy','ymd', "%d %m &y %H:%M:%S %Y"))
dbgap$year =str_split_fixed(dbgap$date, '-', 2)[,1]
dbgap$repository = "dbGaP"
library(tidyverse)
dbgap = fread("../dbpgap/summary_fourth.csv")
dbgap$total = dbgap$male +  dbgap$female +  dbgap$unknown
dbgap$date = parse_date_time(dbgap$date, orders = c('mdy', 'dmy','ymd', "%d %m &y %H:%M:%S %Y"))
library(lubridate)
# Load data
ega = fread("../ega/EGA_with_NULL.csv")
ega_m = melt(ega, id.vars = c("ega_stable_id", "repository", "to_char", "total"))
colnames(ega_m)[colnames(ega_m) == "ega_stable_id"] = "dataset_id"
dbgap = fread("../dbpgap/summary_fourth.csv")
dbgap$total = dbgap$male +  dbgap$female +  dbgap$unknown
dbgap$date = parse_date_time(dbgap$date, orders = c('mdy', 'dmy','ymd', "%d %m &y %H:%M:%S %Y"))
dbgap$year =str_split_fixed(dbgap$date, '-', 2)[,1]
dbgap$repository = "dbGaP"
dbgap$year[dbgap$year==""] = "NA"
dbgap = subset(dbgap, year > 2017)
dbgap_m = melt(dbgap, id.vars= c("V1", "n", "dataset_id", "filename", "date", "total", "year", "repository"))
# bind datasets
ega_dbgap = rbindlist(list(ega_m, dbgap_m), use.names = T, fill = T)
################
# sample level #
################
ega_dbgap_percent = ega_dbgap %>% group_by(variable, repository) %>%
summarise(value_percent = sum(value) / sum(total))
sample_plot_percent = ggplot(ega_dbgap_percent, aes(x=variable, y = value_percent, fill=variable))+
geom_bar(stat="identity", width= 0.75)+
ylab("Percentage of samples")+
xlab("Biological sex specification")+
theme_minimal()+
scale_y_continuous(labels=scales::percent) +
facet_grid(~repository)+
scale_fill_manual(values = c("#20639b", "#3caea3","#f6d55c"))+
theme(legend.position = "none",
axis.text.x = element_text(size = 12),
strip.text = element_text(size = 16, face = "bold"))
sample_plot_percent
png('../figures/figure1.png',
width = 1000, height = 500, res = 200)
sample_plot_percent
dev.off()
library(data.table)
library(reshape2)
library(ggplot2)
library(stringr)
library(dplyr)
# Load data
ega = fread("../ega/EGA_with_NULL.csv")
ega$total_all = length(unique(ega$ega_stable_id))
ega$year = str_split_fixed(ega$to_char, '-', 2)[,1]
dbgap = fread("../dbpgap/summary_fourth.csv")
dbgap$total = dbgap$male +  dbgap$female +  dbgap$unknown
dbgap$date = parse_date_time(dbgap$date, orders = c('mdy', 'dmy','ymd', "%d %m &y %H:%M:%S %Y"))
dbgap$year =str_split_fixed(dbgap$date, '-', 2)[,1]
dbgap$repository = "dbGaP"
dbgap$year[dbgap$year==""] = "NA"
dbgap = subset(dbgap, year > 2017)
dbgap$total_all = length(unique(dbgap$dataset_id))
dbgap$phe = substr(dbgap$filename, 8,19)
ega_dbgap = rbind(ega,dbgap, fill = T)
################
# study level  #
################
unknown_only = subset(ega_dbgap, male == 0 & female == 0)
unknown_only$label = "U"
female_only = subset(subset(ega_dbgap, male == 0 & unknown == 0))
female_only$label = 'F'
male_only = subset(ega_dbgap, female == 0 & unknown == 0)
male_only$label = 'M'
female_and_male = subset(ega_dbgap, female != 0 & male != 0 & unknown == 0)
female_and_male$label = 'F&M'
female_and_unknown = subset(ega_dbgap, female != 0 & male == 0 & unknown != 0)
female_and_unknown$label = 'F&U'
male_and_unknown = subset(ega_dbgap, female == 0 & male != 0 & unknown != 0)
male_and_unknown$label = 'M&U'
female_and_male_and_unknown = subset(ega_dbgap, female != 0 & male != 0 & unknown != 0)
female_and_male_and_unknown$label = 'F&M&U'
r = rbind(unknown_only, female_only, male_only, female_and_male, female_and_unknown, male_and_unknown, female_and_male_and_unknown)
r $ c = 1
# percent
ega_dbgap_percent = unique(r %>% group_by(label, repository) %>%
summarise(value_percent = sum(c) / total_all))
f = arrange(ega_dbgap_percent, desc(value_percent))$label
ega_dbgap_percent$label = factor(ega_dbgap_percent$label, levels = unique(f))
study_plot_percent = ggplot(ega_dbgap_percent, aes(x= label,y = value_percent, fill = label))+
geom_bar(stat="identity", width=0.75)+
ylab("Percentage studies")+
xlab("Sex specification in samples found in the study")+
theme_minimal()+
facet_grid(~repository)+
scale_y_continuous(labels=scales::percent) +
theme(legend.position = "none",
axis.text.x = element_text(size = 10, face = "bold"),
# axis.text.x = element_text(size = 12),
strip.text = element_text(size = 16, face = "bold"))
study_plot_percent
png('../figures/figure2.png',
width = 1500, height = 750, res = 200)
study_plot_percent
dev.off()
ega_phe =fread("/media/victoria/VICTORIA_EXTERNAL_DISK/BioHackathon2021/EGA_examples/raw_phenotype_gender_ega.txt")
ega_phe_u = subset(ega_phe , ega_study %in% unknown_only$ega_stable_id)
ega_phe_u $c = 1
ega_phe_u_total = ega_phe_u%>%group_by(phenotype) %>% summarise(total = sum(c))
arrange(ega_phe_u_total, desc(total))
top20 = subset(ega_phe_u_total,total> 720)
top20$phenotype = factor(top20$phenotype, levels = arrange(top20, desc(total))$phenotype)
ggplot(top20, aes(x = phenotype, y = total))+
geom_bar(stat="identity")+
theme_minimal()+
theme(axis.text.x = element_text(size = 10, face = "bold", angle = 45, hjust = 1, vjust = 1),
# axis.text.x = element_text(size = 12),
strip.text = element_text(size = 16, face = "bold"))
library(data.table)
library(reshape2)
library(ggplot2)
library(stringr)
library(dplyr)
library(lubridate)
library(patchwork) # To display 2 charts together
#library(hrbrthemes)
library(cowplot)
# Load data
ega = fread("../ega/all_EGA_samples.txt")
#ega$total_all = length(unique(ega$ega_stable_id))
ega$year = str_split_fixed(ega$date_study, '-', 2)[,1]
colnames(ega)[1] = "dataset_id"
ega_m = melt(ega, id.vars = c("dataset_id", "repository", "date_study", "year", "total"))
ega_m$year[ega_m$year=="1980"] = "NA"
dbgap = fread("../dbpgap/summary_fourth.csv")
dbgap$total = dbgap$male +  dbgap$female +  dbgap$unknown
dbgap$date = parse_date_time(dbgap$date, orders = c('mdy', 'dmy','ymd', "%d %m &y %H:%M:%S %Y"))
dbgap$year =str_split_fixed(dbgap$date, '-', 2)[,1]
dbgap_m = melt(dbgap, id.vars= c("V1", "n", "dataset_id", "filename", "date",'year', "total"))
dbgap_m$repository = "dbGaP"
dbgap_m$year[dbgap_m$year==""] = "NA"
# bind datasets
ega_dbgap = rbindlist(list(ega_m, dbgap_m), use.names = T, fill = T)
#total samples per year
ega_dbgap = ega_dbgap %>% group_by(repository, year) %>% mutate(total_year = sum(value))
################
# sample level #
################
ega_dbgap_percent = subset(ega_dbgap) %>% group_by(variable, repository, year) %>%
summarise(value_percent = sum(value) / sum(total),
total_year = unique(total_year))
ega_dbgap_percent$year = factor(ega_dbgap_percent$year ,
levels = c('NA','2009','2010','2011','2012','2013','2014','2015','2016','2017','2018','2019','2020','2021'))
ega1 = ggplot(subset(ega_dbgap_percent, repository == "EGA"),
aes(x=year,  group=repository))+
# geom_line(aes(y = total_year),fill = "grey30", stat="identity", width= 0.8)+
geom_point(aes(y = total_year), size = 3,  color = "#2ebfc9")+
geom_line(aes(y = total_year), color = "#2ebfc9")+
ylab("# samples")+
xlab("Year")+
theme_minimal()+
facet_grid(repository~.)+
theme(axis.text.x = element_text(size = 10),
strip.text = element_text(size = 16, face = "bold"))
ega1
ega1 = ggplot(subset(ega_dbgap_percent, repository == "EGA"),
aes(x=year,  group=repository))+
# geom_line(aes(y = total_year),fill = "grey30", stat="identity", width= 0.8)+
geom_point(aes(y = total_year), size = 3,  color = "#ed553b")+
geom_line(aes(y = total_year), color = "#2ebfc9")+
ylab("# samples")+
xlab("Year")+
theme_minimal()+
facet_grid(repository~.)+
theme(axis.text.x = element_text(size = 10),
strip.text = element_text(size = 16, face = "bold"))
ega2 = ggplot(subset(ega_dbgap_percent, repository =="EGA"),
aes(x=year,  color=variable, group=variable))+
# geom_line(aes(y = total_year),fill = "grey30", stat="identity", width= 0.8)+
geom_point(aes(y = value_percent), size = 3)+
geom_line(aes(y = value_percent))+
ylab("Percentage of samples")+
xlab("Year")+
theme_minimal()+
scale_y_continuous(labels=scales::percent)+#,
#sec.axis = sec_axis(~.*0.01, name="Second Axis")) +
facet_grid(repository~.)+
scale_color_manual(values = c("#20639b", "#3caea3","#f6d55c"),
labels = c("Male", "Female", "Unknown"),
name ="")+
#scale_x_discrete(labels= c("M", "F", "U"))+
theme(legend.position = "top",
axis.text.x = element_text(size = 10),
strip.text = element_text(size = 16, face = "bold"))
ega1 = ggplot(subset(ega_dbgap_percent, repository == "EGA"),
aes(x=year,  group=repository))+
# geom_line(aes(y = total_year),fill = "grey30", stat="identity", width= 0.8)+
geom_point(aes(y = total_year), size = 3,  color = "#ed553b")+
geom_line(aes(y = total_year), color = "#ed553b")+
ylab("# samples")+
xlab("Year")+
theme_minimal()+
facet_grid(repository~.)+
theme(axis.text.x = element_text(size = 10),
strip.text = element_text(size = 16, face = "bold"))
ega2 = ggplot(subset(ega_dbgap_percent, repository =="EGA"),
aes(x=year,  color=variable, group=variable))+
# geom_line(aes(y = total_year),fill = "grey30", stat="identity", width= 0.8)+
geom_point(aes(y = value_percent), size = 3)+
geom_line(aes(y = value_percent))+
ylab("Percentage of samples")+
xlab("Year")+
theme_minimal()+
scale_y_continuous(labels=scales::percent)+#,
#sec.axis = sec_axis(~.*0.01, name="Second Axis")) +
facet_grid(repository~.)+
scale_color_manual(values = c("#20639b", "#3caea3","#f6d55c"),
labels = c("Male", "Female", "Unknown"),
name ="")+
#scale_x_discrete(labels= c("M", "F", "U"))+
theme(legend.position = "top",
axis.text.x = element_text(size = 10),
strip.text = element_text(size = 16, face = "bold"))
dbgap1 = ggplot(subset(ega_dbgap_percent, repository == "dbGaP"),
aes(x=year,  group=repository))+
# geom_line(aes(y = total_year),fill = "grey30", stat="identity", width= 0.8)+
geom_point(aes(y = total_year), size = 3,  color = "#ed553b")+
geom_line(aes(y = total_year), color = "#ed553b")+
ylab("# samples")+
xlab("Year")+
theme_minimal()+
facet_grid(repository~.)+
theme(axis.text.x = element_text(size = 10),
strip.text = element_text(size = 16, face = "bold"))
dbgap2 = ggplot(subset(ega_dbgap_percent, repository =="dbGaP"),
aes(x=year,  color=variable, group=variable))+
# geom_line(aes(y = total_year),fill = "grey30", stat="identity", width= 0.8)+
geom_point(aes(y = value_percent), size = 3)+
geom_line(aes(y = value_percent))+
ylab("Percentage of samples")+
xlab("Year")+
theme_minimal()+
scale_y_continuous(labels=scales::percent)+#,
ylim(0,1)+
#sec.axis = sec_axis(~.*0.01, name="Second Axis")) +
facet_grid(repository~.)+
scale_color_manual(values = c("#20639b", "#3caea3","#f6d55c"),
labels = c("Male", "Female", "Unknown"),
name ="")+
#scale_x_discrete(labels= c("M", "F", "U"))+
theme(legend.position = "top",
axis.text.x = element_text(size = 10),
strip.text = element_text(size = 16, face = "bold"))
pp = plot_grid(dbgap1, dbgap2,ega1, ega2, labels = c('A', 'B', "C", "D"), ncol = 1, rel_heights = c(0.25,0.5, 0.25, 0.5))
pp
png('../figures/figure3.png',
width = 1500, height = 1500, res = 150)
pp
dev.off()
#########################################
library(data.table)
library(reshape2)
library(ggplot2)
library(stringr)
library(lubridate)
ega = fread("../ega/all_EGA_samples.txt")
ega$total_all = length(unique(ega$ega_stable_id))
ega$year = str_split_fixed(ega$date_study, '-', 2)[,1]
colnames(ega)[1] = "dataset_id"
#d2 = melt(d,id.vars = c("ega_stable_id", "repository", "to_char", "total"))
dbgap = fread("../dbpgap/summary_fourth.csv")
dbgap$total = dbgap$male +  dbgap$female +  dbgap$unknown
dbgap$repository="dbGaP"
dbgap$total_all = length(unique(dbgap$dataset_id))
dbgap$date = parse_date_time(dbgap$date, orders = c('mdy', 'dmy','ymd', "%d %m &y %H:%M:%S %Y"))
dbgap$year =str_split_fixed(dbgap$date, '-', 2)[,1]
ega_dbgap = rbind(ega,dbgap, fill = T)
ega_dbgap
library(reshape2)
ega_dbgap_m = melt(ega_dbgap[,c(1:5,7:9)],
id.vars = c("dataset_id", "repository", "year", "total", "total_all"))
library(dplyr)
ega_dbgap_m_percent = ega_dbgap_m %>%
mutate(value_percent = (value / total) * 100)
library(ggplot2)
bp = ggplot(subset(ega_dbgap_m_percent, !year %in% c("",1980)),
aes(x = variable, y = value_percent , color = variable))+
# geom_dotplot()+
#geom_violin()+
geom_boxplot(width=0.5)+
facet_grid(repository~year)+
ylab("Percentage of samples")+
scale_color_manual(values = c("#20639b", "#3caea3","#f6d55c"),
labels = c("Male (M)", "Female (F)", "Unknown (U)"),
name ="")+
xlab("Sex classification")+
scale_x_discrete(labels= c("M", "F", "U"))+
theme_minimal()+
theme(legend.position="top",
strip.text = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 9))
bp
png('../figures/figure4.png',
width = 3000, height = 1000, res = 250)
bp
dev.off()
# Load data
d = fread("/media/victoria/VICTORIA_EXTERNAL_DISK/BioHackathon2021/EGA_examples/EGA_with_NULL.csv")
d
########################################3
# all_EGA_samples.txt
#########################################
library(data.table)
library(stringr)
all_ega_samples = fread("/media/victoria/VICTORIA_EXTERNAL_DISK/BioHackathon2021/EGA_examples/all_EGA_samples.txt")
all_ega_samples
################################################
# Mauricio's data
library(data.table)
library(stringr)
raw = readLines("/media/victoria/VICTORIA_EXTERNAL_DISK/BioHackathon2021/EGA_examples/raw_data_sample_tag.txt")
raw = as.data.frame(str_split_fixed(raw, ',', 8))
raw = data.table(raw)
colnames(raw) = c('ega_study','study_date', 'ega_dataset','dataset_date', 'ega_sample','sample_date', 'variable', 'value')
library(reshape2)
library(dplyr)
library(tidyr)
raw_pg = subset(raw, variable %in% c("phenotype", "gender"))
raw_pg_spread = raw_pg %>% spread(variable, value)
raw_pg_spread$dataset_year = str_split_fixed(raw_pg_spread$dataset_date, '-', 2)[,1]
unique(raw_pg_spread$dataset_year)
raw_pg_spread
raw_pg_spread$sample_year = str_split_fixed(raw_pg_spread$sample_creationTime, '-', 2)[,1]
unique(raw_pg_spread$sample_year)
sample_date = unique(raw_pg_spread[,c("ega_sample","gender", "dataset_year")])
sample_date$gender[is.na(sample_date$gender )] = "unknown"
sample_date
library(ggplot2)
sample_date_plot = ggplot(sample_date,aes(x = gender, fill = gender))+
geom_bar (stat="count")+
facet_grid(~dataset_year)+
ylab("Samples number")+
xlab("Biological sex classification")+
scale_y_continuous(labels=scales::percent) +
theme_bw()+
theme(legend.position = "none",
axis.text.x = element_text(size = 7, face = "bold"))
sample_date_plot
sample_date
sample_date$n = 1
total = length(unique(sample_date$ega_sample))
raw
length(unique(raw$ega_study))
sum_sample_date = unique(sample_date[,1:2]) %>% group_by (gender) %>% summarise (sum(n)/total)
sum_sample_date = unique(sample_date[,1:2]) %>% group_by (gender) %>% summarise (percent = sum(n)/total * 100)
head(sample_date[,1:2])
sum_sample_date = unique(sample_date[,c(1:2,4)]) %>% group_by (gender) %>% summarise (percent = sum(n)/total * 100)
sum_sample_date
sample_date_plot = ggplot(sum_sample_date,aes(x = gender,y = percent, fill = gender))+
geom_bar (stat="identity")+
#facet_grid(~dataset_year)+
ylab("Samples number")+
xlab("Biological sex classification")+
scale_y_continuous(labels=scales::percent) +
theme_bw()+
theme(legend.position = "none",
axis.text.x = element_text(size = 7, face = "bold"))
sample_date_plot = ggplot(sum_sample_date,aes(x = gender,y = percent, fill = gender))+
geom_bar (stat="identity")+
#facet_grid(~dataset_year)+
ylab("Percentage of unique samples")+
xlab("Biological sex specification")+
theme_minimal()+
scale_fill_manual(values = c("#20639b", "#3caea3","#f6d55c"))+
theme_bw()+
theme(legend.position = "none",
axis.text.x = element_text(size = 7, face = "bold"))
sample_date_plot
sample_date_plot = ggplot(sum_sample_date,aes(x = gender,y = percent, fill = gender))+
geom_bar (stat="identity")+
#facet_grid(~dataset_year)+
ylab("Percentage of unique samples")+
xlab("Biological sex specification")+
theme_minimal()+
scale_fill_manual(values = c("#20639b", "#3caea3","#f6d55c"))+
theme_bw()+
theme(legend.position = "none",
axis.text.x = element_text(size = 12),
strip.text = element_text(size = 16, face = "bold"))
sample_date_plot
sum_sample_date
sum_sample_date $gender = factor(sum_sample_date $gender, levels = c("male", "female", "unknown"))
sample_date_plot = ggplot(sum_sample_date,aes(x = gender,y = percent, fill = gender))+
geom_bar (stat="identity")+
#facet_grid(~dataset_year)+
ylab("Percentage of unique samples")+
xlab("Biological sex specification")+
theme_minimal()+
scale_fill_manual(values = c("#20639b", "#3caea3","#f6d55c"))+
theme_bw()+
theme(legend.position = "none",
axis.text.x = element_text(size = 12),
strip.text = element_text(size = 16, face = "bold"))
sample_date_plot
png('../figures/figureS1.png',
width = 1000, height = 500, res = 200)
sample_plot_percent
dev.off()
sample_date_percent
png('../figures/figureS1.png',
width = 1000, height = 500, res = 200)
sample_date_plot
dev.off()
png('../figures/figureS1.png',
width = 500, height = 500, res = 200)
sample_date_plot
dev.off()
png('../figures/figureS1.png',
width = 700, height = 700, res = 200)
sample_date_plot
dev.off()
