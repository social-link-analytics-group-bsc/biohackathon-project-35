fmu
all = ggplot(subset(r_m_percent &  year !="NA" & !is.na(year)),
aes(x = variable, y =percent, color = variable) )+
geom_boxplot()+
facet_grid(repository~year )+
ylab("Percentage of samples")+
scale_color_manual(values = c("#20639b", "#3caea3","#f6d55c"),
labels = c("Male (M)", "Female (F)", "Unknown (U)"),
name ="")+
xlab("Sex classification")+
scale_x_discrete(labels= c("M", "F", "U"))+
theme_minimal()+
theme(legend.position="top",
strip.text = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 9))
all
png('../figures/figureS5.png',
width = 3000, height = 1500, res = 300)
all
dev.off()
r_m_percent
unique(r_m_percent$year)
unique(subset(r_m_percent &  year !="NA" & !is.na(year))$year)
unique(subset(r_m_percent &   !is.na(year))$year)
subset(r_m_percent &  year !="NA")
r_m_percent$year = as.character(r_m_percent$year)
all = ggplot(subset(r_m_percent &  year !="NA" & !is.na(year)),
aes(x = variable, y =percent, color = variable) )+
geom_boxplot()+
facet_grid(repository~year )+
ylab("Percentage of samples")+
scale_color_manual(values = c("#20639b", "#3caea3","#f6d55c"),
labels = c("Male (M)", "Female (F)", "Unknown (U)"),
name ="")+
xlab("Sex classification")+
scale_x_discrete(labels= c("M", "F", "U"))+
theme_minimal()+
theme(legend.position="top",
strip.text = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 9))
all = ggplot(subset(r_m_percent &   !is.na(year)),
aes(x = variable, y =percent, color = variable) )+
geom_boxplot()+
facet_grid(repository~year )+
ylab("Percentage of samples")+
scale_color_manual(values = c("#20639b", "#3caea3","#f6d55c"),
labels = c("Male (M)", "Female (F)", "Unknown (U)"),
name ="")+
xlab("Sex classification")+
scale_x_discrete(labels= c("M", "F", "U"))+
theme_minimal()+
theme(legend.position="top",
strip.text = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 9))
r = rbind(unknown_only, female_only, male_only, female_and_male, female_and_unknown, male_and_unknown, female_and_male_and_unknown)
r_m = melt(r, id.vars = c("study_id",
"total", "date_study",
"repository", "year", "total_all","label"))
#r_m = r_m %>% group_by(year, repository,label) %>% mutate(total_year = sum(value))
r_m_percent = r_m %>%
group_by(year, repository, label,variable) %>%
mutate(percent = value/ total)
r_m_percent$year[r_m_percent$year=='1980'] ='NA'
#r_m = r_m %>% group_by(year, repository,label) %>% mutate(total_year = sum(value))
r_m_percent = r_m %>%
group_by(year, repository, label,variable) %>%
mutate(percent = value/ total)
subset(r_m_percent, !is.na(year))
#r_m = r_m %>% group_by(year, repository,label) %>% mutate(total_year = sum(value))
r_m_percent = r_m %>%
group_by(year, repository, label,variable) %>%
mutate(percent = value/ total)
r_m_percent = subset(r_m_percent, !is.na(year) & year!= '1980')
r_m_percent$year = factor (r_m_percent$year,
levels = c( '1980','2009','2010','2011','2012','2013','2014','2015','2016','2017','2018','2019','2020','2021' ))
r_m_percent$year = as.character(r_m_percent$year)
all = ggplot(subset(r_m_percent &   !is.na(year)),
aes(x = variable, y =percent, color = variable) )+
geom_boxplot()+
facet_grid(repository~year )+
ylab("Percentage of samples")+
scale_color_manual(values = c("#20639b", "#3caea3","#f6d55c"),
labels = c("Male (M)", "Female (F)", "Unknown (U)"),
name ="")+
xlab("Sex classification")+
scale_x_discrete(labels= c("M", "F", "U"))+
theme_minimal()+
theme(legend.position="top",
strip.text = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 9))
all
png('../figures/figureS5.png',
width = 3000, height = 1500, res = 300)
all
unique(r_m_percent$year)
#r_m = r_m %>% group_by(year, repository,label) %>% mutate(total_year = sum(value))
r_m_percent = r_m %>%
group_by(year, repository, label,variable) %>%
mutate(percent = value/ total)
r_m_percent = subset(r_m_percent, !is.na(year) & year!= '1980')
unique(r_m_percent$year)
#r_m = r_m %>% group_by(year, repository,label) %>% mutate(total_year = sum(value))
r_m_percent = r_m %>%
group_by(year, repository, label,variable) %>%
mutate(percent = value/ total)
r_m_percent = subset(r_m_percent, !is.na(year) & year!= '1980' & year != "NA")
unique(r_m_percent$year)
r_m_percent$year = factor (r_m_percent$year,
levels = c( '1980','2009','2010','2011','2012','2013','2014','2015','2016','2017','2018','2019','2020','2021' ))
all = ggplot(subset(r_m_percent &   !is.na(year)),
aes(x = variable, y =percent, color = variable) )+
geom_boxplot()+
facet_grid(repository~year )+
ylab("Percentage of samples")+
scale_color_manual(values = c("#20639b", "#3caea3","#f6d55c"),
labels = c("Male (M)", "Female (F)", "Unknown (U)"),
name ="")+
xlab("Sex classification")+
scale_x_discrete(labels= c("M", "F", "U"))+
theme_minimal()+
theme(legend.position="top",
strip.text = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 9))
all
png('../figures/figureS5.png',
width = 3000, height = 1500, res = 300)
all
dev.off()
fmu = ggplot(subset(r_m_percent, label == "F&M&U" & year !="NA"),
aes(x = variable, y =percent, color = variable) )+
geom_boxplot()+
facet_grid(repository~year )+
ylab("Percentage of samples")+
scale_color_manual(values = c("#20639b", "#3caea3","#f6d55c"),
labels = c("Male (M)", "Female (F)", "Unknown (U)"),
name ="")+
xlab("Sex classification")+
scale_x_discrete(labels= c("M", "F", "U"))+
theme_minimal()+
theme(legend.position="top",
strip.text = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 9))
fmu
png('../figures/figureS6.png',
width = 3000, height = 1500, res = 300)
fmu
dev.off()
all
all = ggplot(subset(r_m_percent),
aes(x = variable, y =percent, color = variable) )+
geom_boxplot()+
facet_grid(repository~year )+
ylab("Percentage of samples")+
scale_color_manual(values = c("#20639b", "#3caea3","#f6d55c"),
labels = c("Male (M)", "Female (F)", "Unknown (U)"),
name ="")+
xlab("Sex classification")+
scale_x_discrete(labels= c("M", "F", "U"))+
theme_minimal()+
theme(legend.position="top",
strip.text = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 9))
all
all
png('../figures/figureS5.png',
width = 3000, height = 1500, res = 300)
all
dev.off()
library(data.table)
library(reshape2)
library(ggplot2)
library(stringr)
library(dplyr)
library(lubridate)
library(patchwork) # To display 2 charts together
#library(hrbrthemes)
library(cowplot)
# Load data
ega = fread("../ega/all_EGA_samples.txt")
#ega$total_all = length(unique(ega$ega_stable_id))
ega$year = str_split_fixed(ega$date_study, '-', 2)[,1]
colnames(ega)[1] = "study_id"
ega_m = melt(ega, id.vars = c("study_id", "repository", "date_study", "year", "total"))
dbgap = fread("../dbpgap/summary_fourth.csv")
dbgap$total = dbgap$male +  dbgap$female +  dbgap$unknown
dbgap$date = parse_date_time(dbgap$date, orders = c('mdy', 'dmy','ymd', "%d %m &y %H:%M:%S %Y"))
dbgap$year =str_split_fixed(dbgap$date, '-', 2)[,1]
spl = str_split_fixed(str_remove(dbgap$filename,'\\.\\/data\\/'), '\\.',6)
dbgap$study_id = paste(spl[,1],spl[,2],spl[,5], sep=".")
dbgap2 =dbgap%>%group_by(study_id)%>%
summarise(male = sum(male),
female = sum(female),
unknown = sum (unknown),
total = sum (total),
year = max(year))
ega_m = melt(ega, id.vars = c("study_id", "repository", "date_study", "year", "total"))
ega_m$year[ega_m$year=="1980"] = NA
dbgap_m = melt(dbgap2, id.vars= c("study_id", 'year', "total"))
dbgap_m$repository = "dbGaP"
dbgap_m$year[dbgap_m$year==""] = NA
# bind datasets
ega_dbgap = rbindlist(list(ega_m, dbgap_m), use.names = T, fill = T)
#total samples per year
ega_dbgap = ega_dbgap %>% group_by(repository, year) %>% mutate(total_year = sum(value))
#########################################
library(data.table)
library(reshape2)
library(ggplot2)
library(stringr)
library(lubridate)
ega = fread("../ega/all_EGA_samples.txt")
ega$total_all = length(unique(ega$ega_stable_id))
ega$year = str_split_fixed(ega$date_study, '-', 2)[,1]
colnames(ega)[1] = "dataset_id"
#d2 = melt(d,id.vars = c("ega_stable_id", "repository", "to_char", "total"))
dbgap = fread("../dbpgap/summary_fourth.csv")
dbgap$total = dbgap$male +  dbgap$female +  dbgap$unknown
dbgap$date = parse_date_time(dbgap$date, orders = c('mdy', 'dmy','ymd', "%d %m &y %H:%M:%S %Y"))
dbgap$year =str_split_fixed(dbgap$date, '-', 2)[,1]
spl = str_split_fixed(str_remove(dbgap$filename,'\\.\\/data\\/'), '\\.',6)
dbgap$study_id = paste(spl[,1],spl[,2],spl[,5], sep=".")
dbgap2 =dbgap%>%group_by(study_id)%>%
summarise(male = sum(male),
female = sum(female),
unknown = sum (unknown),
total = sum (total),
year = max(year))
dbgap_m = melt(dbgap2, id.vars= c("study_id", 'year', "total"))
dbgap_m$repository = "dbGaP"
dbgap_m$year[dbgap_m$year==""] = NA
ega_dbgap = rbind(ega,dbgap, fill = T)
ll2 = ega_dbgap%>% group_by(year, repository, variable) %>% summarise(samples = sum(value))
ega_dbgap = rbind(ega_m,dbgap_m, fill = T)
ega_m = melt(ega, id.vars = c("dataset_id", "repository", "date_study", "year", "total"))
ega_m$year[ega_m$year=="1980"] = "NA"
ega_dbgap = rbind(ega_m,dbgap_m, fill = T)
ll2 = ega_dbgap%>% group_by(year, repository, variable) %>% summarise(samples = sum(value))
dbgap
dbgap$total = dbgap$male +  dbgap$female +  dbgap$unknown
dbgap$date = parse_date_time(dbgap$date, orders = c('mdy', 'dmy','ymd', "%d %m &y %H:%M:%S %Y"))
dbgap$year =str_split_fixed(dbgap$date, '-', 2)[,1]
spl = str_split_fixed(str_remove(dbgap$filename,'\\.\\/data\\/'), '\\.',6)
dbgap$study_id = paste(spl[,1],spl[,2],spl[,5], sep=".")
dbgap
dbgap_m
ll2 = ega_dbgap%>% group_by(year, repository, variable) %>% summarise(samples = sum(value))
ega_dbgap
ega_m
ega_dbgap = rbind(ega_m,dbgap_m, fill = T)
colnames(egam_m)
colnames(ega_m)
colnames(dbgap_m)
ega = fread("../ega/all_EGA_samples.txt")
ega$total_all = length(unique(ega$ega_stable_id))
ega$year = str_split_fixed(ega$date_study, '-', 2)[,1]
colnames(ega)[1] = "study_id"
ega_m = melt(ega, id.vars = c("study_id", "repository", "date_study", "year", "total"))
ega_m$year[ega_m$year=="1980"] = "NA"
ega_dbgap = rbind(ega_m,dbgap_m, fill = T)
ega_m
colnames(ega_m)
colnames(dbgap_m)
ega_dbgap = rbindlist(list(ega_m,dbgap_m), fill = T)
ll2 = ega_dbgap%>% group_by(year, repository, variable) %>% summarise(samples = sum(value))
ll2
samples_year=ggplot(subset(ll2),
aes(x = as.numeric(year), y = samples, group = variable, color = variable))+
geom_point()+
geom_line()+
facet_grid(repository~., scales="free_y")+
theme_minimal()+
ylab("# samples")+
xlab("Year")
sample_year
ll2 = ega_dbgap%>% group_by(year, repository, variable) %>% summarise(samples = sum(value))
samples_year=ggplot(subset(ll2),
aes(x = as.numeric(year), y = samples, group = variable, color = variable))+
geom_point()+
geom_line()+
facet_grid(repository~., scales="free_y")+
theme_minimal()+
ylab("# samples")+
xlab("Year")
samples_year
ega = fread("../ega/all_EGA_samples.txt")
#ega$total_all = length(unique(ega$ega_stable_id))
ega$year = str_split_fixed(ega$date_study, '-', 2)[,1]
colnames(ega)[1] = "study_id"
ega_m = melt(ega, id.vars = c("study_id", "repository", "date_study", "year", "total"))
ega_m$year[ega_m$year=="1980"] = "NA"
#d2 = melt(d,id.vars = c("ega_stable_id", "repository", "to_char", "total"))
dbgap = fread("../dbpgap/summary_fourth.csv")
#dbgap$total = dbgap$male +  dbgap$female +  dbgap$unknown
dbgap$date = parse_date_time(dbgap$date, orders = c('mdy', 'dmy','ymd', "%d %m &y %H:%M:%S %Y"))
dbgap$year =str_split_fixed(dbgap$date, '-', 2)[,1]
spl = str_split_fixed(str_remove(dbgap$filename,'\\.\\/data\\/'), '\\.',6)
dbgap$study_id = paste(spl[,1],spl[,2],spl[,5], sep=".")
dbgap2 =dbgap%>%group_by(study_id)%>%
summarise(male = sum(male),
female = sum(female),
unknown = sum (unknown),
# total = sum (total),
year = max(year))
dbgap_m = melt(dbgap2, id.vars= c("study_id", 'year', "total"))
dbgap_m$repository = "dbGaP"
dbgap_m$year[dbgap_m$year==""] = NA
ega_dbgap = rbindlist(list(ega_m,dbgap_m), fill = T)
ll2 = ega_dbgap%>% group_by(year, repository, variable) %>% summarise(samples = sum(value))
samples_year=ggplot(subset(ll2),
aes(x = as.numeric(year), y = samples, group = variable, color = variable))+
geom_point()+
geom_line()+
facet_grid(repository~., scales="free_y")+
theme_minimal()+
ylab("# samples")+
xlab("Year")
samples_year
png('../figures/figureS3.png',
width = 1500, height = 1500, res = 300)
samples_year
dev.off()
png('../figures/figureS3.png',
width = 1500, height = 1000, res = 300)
samples_year
dev.off()
png('../figures/figureS3.png',
width = 2000, height = 1000, res = 300)
samples_year
dev.off()
png('../figures/figureS3.png',
width = 2500, height = 1000, res = 300)
samples_year
dev.off()
ega = fread("../ega/all_EGA_samples.txt")
ega$total_all = length(unique(ega$ega_stable_id))
ega$year = str_split_fixed(ega$date_study, '-', 2)[,1]
#d2 = melt(d,id.vars = c("ega_stable_id", "repository", "to_char", "total"))
dbgap = fread("../dbpgap/summary_fourth.csv")
dbgap$total = dbgap$male +  dbgap$female +  dbgap$unknown
dbgap$repository="dbGaP"
spl = str_split_fixed(str_remove(dbgap$filename,'\\.\\/data\\/'), '\\.',6)
dbgap$study_id = paste(spl[,1],spl[,2],spl[,5], sep=".")
dbgap$date = parse_date_time(dbgap$date, orders = c('mdy', 'dmy','ymd', "%d %m &y %H:%M:%S %Y"))
dbgap$year =str_split_fixed(dbgap$date, '-', 2)[,1]
dbgapb =dbgap%>%group_by(study_id,repository)%>%
summarise(male = sum(male),
female = sum(female),
unknown = sum (unknown),
total = sum (total),
year = max(year))
dbgapb$total_all = length(unique(dbgapb$study_id))
#ega_dbgap = rbind(ega,dbgap[colnames(ega[,-6])])
ega_dbgap = rbind(ega,dbgapb, fill = T)
ega_dbgap_summary = ega_dbgap%>% group_by(repository, year, variable)%>%
summarise(mean_samples = mean(value),
sd = sd(value))
ega = fread("../ega/all_EGA_samples.txt")
#ega$total_all = length(unique(ega$ega_stable_id))
ega$year = str_split_fixed(ega$date_study, '-', 2)[,1]
colnames(ega)[1] = "study_id"
ega_m = melt(ega, id.vars = c("study_id", "repository", "date_study", "year", "total"))
ega_m$year[ega_m$year=="1980"] = "NA"
#d2 = melt(d,id.vars = c("ega_stable_id", "repository", "to_char", "total"))
dbgap = fread("../dbpgap/summary_fourth.csv")
#dbgap$total = dbgap$male +  dbgap$female +  dbgap$unknown
dbgap$date = parse_date_time(dbgap$date, orders = c('mdy', 'dmy','ymd', "%d %m &y %H:%M:%S %Y"))
dbgap$year =str_split_fixed(dbgap$date, '-', 2)[,1]
spl = str_split_fixed(str_remove(dbgap$filename,'\\.\\/data\\/'), '\\.',6)
dbgap$study_id = paste(spl[,1],spl[,2],spl[,5], sep=".")
dbgap2 =dbgap%>%group_by(study_id)%>%
summarise(male = sum(male),
female = sum(female),
unknown = sum (unknown),
# total = sum (total),
year = max(year))
dbgap_m = melt(dbgap2, id.vars= c("study_id", 'year', "total"))
dbgap_m$repository = "dbGaP"
dbgap_m$year[dbgap_m$year==""] = NA
ega_dbgap = rbindlist(list(ega_m,dbgap_m), fill = T)
ega_dbgap
ega_dbgap_summary = ega_dbgap%>% group_by(repository, year, variable)%>%
summarise(mean_samples = mean(value),
sd = sd(value))
ega_dbgap
ega = fread("../ega/all_EGA_samples.txt")
#ega$total_all = length(unique(ega$ega_stable_id))
ega$year = str_split_fixed(ega$date_study, '-', 2)[,1]
colnames(ega)[1] = "study_id"
ega_m = melt(ega, id.vars = c("study_id", "repository", "date_study", "year", "total"))
ega_m$year[ega_m$year=="1980"] = "NA"
ega_dbgap = rbindlist(list(ega_m,dbgap_m), fill = T)
ega_dbgap
ega = fread("../ega/all_EGA_samples.txt")
#ega$total_all = length(unique(ega$ega_stable_id))
ega$year = str_split_fixed(ega$date_study, '-', 2)[,1]
colnames(ega)[1] = "study_id"
ega_m = melt(ega, id.vars = c("study_id", "repository", "date_study", "year", "total"))
ega_m$year[ega_m$year=="1980"] = "NA"
ega_m
#d2 = melt(d,id.vars = c("ega_stable_id", "repository", "to_char", "total"))
dbgap = fread("../dbpgap/summary_fourth.csv")
#dbgap$total = dbgap$male +  dbgap$female +  dbgap$unknown
dbgap$date = parse_date_time(dbgap$date, orders = c('mdy', 'dmy','ymd', "%d %m &y %H:%M:%S %Y"))
dbgap$year =str_split_fixed(dbgap$date, '-', 2)[,1]
spl = str_split_fixed(str_remove(dbgap$filename,'\\.\\/data\\/'), '\\.',6)
dbgap$study_id = paste(spl[,1],spl[,2],spl[,5], sep=".")
dbgap2 =dbgap%>%group_by(study_id)%>%
summarise(male = sum(male),
female = sum(female),
unknown = sum (unknown),
# total = sum (total),
year = max(year))
dbgap_m = melt(dbgap2, id.vars= c("study_id", 'year', "total"))
dbgap_m$repository = "dbGaP"
dbgap_m$year[dbgap_m$year==""] = NA
ega
#d2 = melt(d,id.vars = c("ega_stable_id", "repository", "to_char", "total"))
dbgap = fread("../dbpgap/summary_fourth.csv")
dbgap$total = dbgap$male +  dbgap$female +  dbgap$unknown
dbgap$date = parse_date_time(dbgap$date, orders = c('mdy', 'dmy','ymd', "%d %m &y %H:%M:%S %Y"))
dbgap$year =str_split_fixed(dbgap$date, '-', 2)[,1]
spl = str_split_fixed(str_remove(dbgap$filename,'\\.\\/data\\/'), '\\.',6)
dbgap$study_id = paste(spl[,1],spl[,2],spl[,5], sep=".")
dbgap2 =dbgap%>%group_by(study_id)%>%
summarise(male = sum(male),
female = sum(female),
unknown = sum (unknown),
# total = sum (total),
year = max(year))
dbgap_m = melt(dbgap2, id.vars= c("study_id", 'year', "total"))
dbgap_m$repository = "dbGaP"
dbgap_m$year[dbgap_m$year==""] = NA
dbgap_m = melt(dbgap2, id.vars= c("study_id", 'year', "total"))
dbgap2 =dbgap%>%group_by(study_id)%>%
summarise(male = sum(male),
female = sum(female),
unknown = sum (unknown),
total = sum (total),
year = max(year))
dbgap_m = melt(dbgap2, id.vars= c("study_id", 'year', "total"))
dbgap_m$repository = "dbGaP"
dbgap_m$year[dbgap_m$year==""] = NA
ega_dbgap = rbindlist(list(ega_m,dbgap_m), fill = T)
ega_dbgap
ega_dbgap_summary = ega_dbgap%>% group_by(repository, year, variable)%>%
summarise(mean_samples = mean(value),
sd = sd(value))
ggplot(subset(ega_dbgap_summary),
aes(y = mean_samples, x = year, fill = variable, group= variable))+
# geom_line() +
#geom_point()+
geom_bar(stat = "identity")+
#geom_errorbar(aes(ymin=mean_samples-sd, ymax=mean_samples+sd), width=.2,
#              position=position_dodge(0.05))+
facet_grid(repository~., scales = "free_y")+
ylab("mean # of samples per study")
ggplot(subset(ega_dbgap_summary, !is.na(year)),
aes(y = mean_samples, x = year, fill = variable, group= variable))+
# geom_line() +
#geom_point()+
geom_bar(stat = "identity")+
#geom_errorbar(aes(ymin=mean_samples-sd, ymax=mean_samples+sd), width=.2,
#              position=position_dodge(0.05))+
facet_grid(repository~., scales = "free_y")+
ylab("mean # of samples per study")
subset(ega_dbgap_summary, !is.na(year))
subset(ega_dbgap_summary, !is.na(year) & year !='NA')
ggplot(subset(ega_dbgap_summary, !is.na(year)&year!='NA'),
aes(y = mean_samples, x = year, fill = variable, group= variable))+
# geom_line() +
#geom_point()+
geom_bar(stat = "identity")+
#geom_errorbar(aes(ymin=mean_samples-sd, ymax=mean_samples+sd), width=.2,
#              position=position_dodge(0.05))+
facet_grid(repository~., scales = "free_y")+
ylab("mean # of samples per study")
ggplot(subset(ega_dbgap_summary, !is.na(year)&year!='NA'),
aes(y = mean_samples, x = year, fill = variable, group= variable))+
# geom_line() +
#geom_point()+
geom_bar(stat = "identity")+
#geom_errorbar(aes(ymin=mean_samples-sd, ymax=mean_samples+sd), width=.2,
#              position=position_dodge(0.05))+
facet_grid(repository~., scales = "free_y")+
ylab("mean # of samples per study")+
theme_minimal()
g = ggplot(subset(ega_dbgap_summary, !is.na(year)&year!='NA'),
aes(y = mean_samples, x = year, fill = variable, group= variable))+
# geom_line() +
#geom_point()+
geom_bar(stat = "identity")+
#geom_errorbar(aes(ymin=mean_samples-sd, ymax=mean_samples+sd), width=.2,
#              position=position_dodge(0.05))+
facet_grid(repository~., scales = "free_y")+
ylab("mean # of samples per study")+
theme_minimal()
png('../figures/figureS4.png',
width = 2500, height = 1000, res = 300)
g
dev.off()
png('../figures/figureS4.png',
width = 2000, height = 1000, res = 300)
g
dev.off()
png('../figures/figureS4.png',
width = 1500, height = 1000, res = 300)
g
dev.off()
png('../figures/figureS4.png',
width = 2000, height = 1500, res = 300)
g
dev.off()
